#include "api.h"

inline unsigned int clz(unsigned int a) {
    unsigned int res = 0;

    asm("clz %0, %1" : "=r"(res) : "r"(a));

    return res;
}

inline unsigned int ctz(unsigned int a) {
    unsigned int res = 0;

    asm("ctz %0, %1" : "=r"(res) : "r"(a));

    return res;
}

inline unsigned int cpop(unsigned int a) {
    unsigned int res = 0;

    asm("cpop %0, %1" : "=r"(res) : "r"(a));

    return res;
}

int main() {
    int error = 0;

	error += clz(0b00000000'00000000'00000000'00000000) != 32;
	error += clz(0b00000000'00000000'00000000'00000001) != 31;
	error += clz(0b11111111'11111111'11111111'11111111) !=  0;
	error += clz(0b10000000'00000000'00000000'00000000) !=  0;
	error += clz(0b01000000'00000000'00000000'00000000) !=  1;
	error += clz(0b00100000'00000000'00000000'00000000) !=  2;
	error += clz(0b00000000'00000000'10000000'00000000) != 16;
	error += clz(0b00000000'11110000'00000000'00000000) !=  8;
	error += clz(0b00000000'00000000'00000000'00010000) != 27;
	error += clz(0b01111111'11111111'11111111'11111111) !=  1;

	error += ctz(0b00000000'00000000'00000000'00000000) != 32;
	error += ctz(0b00000000'00000000'00000000'00000001) !=  0;
	error += ctz(0b00000000'00000000'00000000'00000010) !=  1;
	error += ctz(0b00000000'00000000'00000000'00000100) !=  2;
	error += ctz(0b11111111'11111111'11111111'11111111) !=  0;
	error += ctz(0b11111111'11111111'11111111'11111110) !=  1;
	error += ctz(0b11111111'11111111'11111111'11111000) !=  3;
	error += ctz(0b00000000'00000000'10000000'00000000) != 15;
	error += ctz(0b10000000'00000000'00000000'00000000) != 31;
	error += ctz(0b00000000'11110000'00000000'00000000) != 20;

	error += cpop(0b00000000'00000000'00000000'00000000) !=  0;
	error += cpop(0b00000000'00000000'00000000'00000001) !=  1;
	error += cpop(0b11111111'11111111'11111111'11111111) != 32;
	error += cpop(0b10101010'10101010'10101010'10101010) != 16;
	error += cpop(0b01010101'01010101'01010101'01010101) != 16;
	error += cpop(0b10000000'00000000'00000000'00000000) !=  1;
	error += cpop(0b01111111'11111111'11111111'11111111) != 31;
	error += cpop(0b00000000'00000000'11111111'11111111) != 16;
	error += cpop(0b00000000'11110000'11110000'11110000) != 12;
	error += cpop(0b00001111'00001111'00001111'00001111) != 16;

	return error;
}
